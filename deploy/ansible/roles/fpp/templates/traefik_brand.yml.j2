---
http:
  routers:
    send-push-{{ brand_name }}:
      entryPoints:
        - http
      middlewares:
        - fpp-auth
        - remove-auth-header
        - strip-brand-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/send`)
      service: fpp-{{ brand_name }}
    send-push-https-{{ brand_name }}:
      entryPoints:
        - https
      middlewares:
        - fpp-auth
        - remove-auth-header
        - strip-brand-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/send`)
      service: fpp-{{ brand_name }}
      tls: {}
    register-{{ brand_name }}:
      entryPoints:
        - http
      middlewares:
        - strip-brand-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/register`)
      service: fpp-{{ brand_name }}
    register-https-{{ brand_name }}:
      entryPoints:
        - https
      middlewares:
        - strip-brand-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/register`)
      service: fpp-{{ brand_name }}
      tls: {}
    deregister-{{ brand_name }}:
      entryPoints:
        - http
      middlewares:
        - strip-brand-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/deregister`)
      service: fpp-{{ brand_name }}
    deregister-https-{{ brand_name }}:
      entryPoints:
        - https
      middlewares:
        - strip-brand-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/deregister`)
      service: fpp-{{ brand_name }}
      tls: {}
    metrics-{{ brand_name }}:
      entryPoints:
        - http
      middlewares:
        - strip-brand-metrics-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/{{ fpp_metrics_path }}/metrics`)
      service: fpp-{{ brand_name }}
    metrics-https-{{ brand_name }}:
      entryPoints:
        - https
      middlewares:
        - strip-brand-metrics-{{ brand_name }}
      rule: PathPrefix(`/{{ brand_name }}/{{ fpp_metrics_path }}/metrics`)
      service: fpp-{{ brand_name }}
      tls: {}
  middlewares:
    strip-brand-{{ brand_name }}:
      stripPrefix:
        prefixes:
          - "/{{ brand_name }}/"
    strip-brand-metrics-{{ brand_name }}:
      stripPrefix:
        prefixes:
          - "/{{ brand_name }}/{{ fpp_metrics_path }}/"
  services:
    fpp-{{ brand_name }}:
      loadBalancer:
        passHostHeader: false
        servers:
          - url: 'http://localhost:{{ brand_http_port }}'

